<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calibrate Smoking Status • epicR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calibrate Smoking Status">
<style>
/* Event table styles */
.event-table table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 1em;
    font-family: Arial, sans-serif;
    text-align: left;
    border: none;
}
.event-table table th {
    background-color: #f3f4f5;
    font-weight: bold;
    border-bottom: 3px solid #333;
    padding: 10px;
}
.event-table table td {
    padding: 8px;
}
.event-table table tr:nth-child(even) {
    background-color: #f3f4f5;
}
.event-table table tr:nth-child(odd) {
    background-color: #ffffff;
}

/* Dropdown table styles */
.custom-table-container-dropdown table {
    width: 100%;
    table-layout: fixed;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 1em;
    font-family: Arial, sans-serif;
    text-align: left;
    border: 1px solid #ddd;
}
.custom-table-container-dropdown table th {
    background-color: #f3f4f5;
    font-weight: bold;
    border-bottom: 3px solid #333;
    padding: 10px;
    text-align: left;
}
.custom-table-container-dropdown table td {
    padding: 8px;
}
.btn-primary {
    color: #fff;
    background-color: #007bff;
    border: none;
    padding: 5px 10px;
    font-size: 0.9em;
    cursor: pointer;
    border-radius: 3px;
}
.btn-primary:hover {
    background-color: #0056b3;
}
.custom-collapse {
    margin-top: 10px;
    padding: 10px;
    border: 1px solid #ddd;
    background-color: #f9f9f9;
    display: none;
}
.custom-collapse.show {
    display: block;
}

/* General table styles */
.custom-table-container table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 1em;
    font-family: Arial, sans-serif;
    text-align: left;
    border: 1px solid #ddd;
}
.custom-table-container table th {
    background-color: #f3f4f5;
    font-weight: bold;
    border-bottom: 3px solid #333;
    padding: 10px;
    text-align: left;
}
.custom-table-container table td {
    padding: 8px;
    border-bottom: 1px solid #ddd;
}
.custom-table-container table tr:nth-child(even) {
    background-color: #f9f9f9;
}
.custom-table-container table tr:nth-child(odd) {
    background-color: #ffffff;
}
.custom-table-container table tr:hover {
    background-color: #b780ff;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.btn-primary').forEach(function(button) {
    button.addEventListener('click', function() {
      var target = document.querySelector(button.getAttribute('data-target'));
      if (target) {
        target.classList.toggle('show');
      }
    });
  });
});
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epicR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/AddingNewCountry.html">Adding a New Country to epicR</a></li>
    <li><a class="dropdown-item" href="../articles/BackgroundEPIC.html">EPIC Background</a></li>
    <li><a class="dropdown-item" href="../articles/Calibrate_COPD_Exacerbations.html">Calibrate COPD Exacerbations</a></li>
    <li><a class="dropdown-item" href="../articles/Calibrate_COPD_Prevalence.html">Calibrate COPD Prevalence</a></li>
    <li><a class="dropdown-item" href="../articles/Calibrate_Demographics.html">Calibrate Demographics</a></li>
    <li><a class="dropdown-item" href="../articles/Calibrate_Smoking.html">Calibrate Smoking Status</a></li>
    <li><a class="dropdown-item" href="../articles/GettingStarted.html">Getting Started with EPIC</a></li>
    <li><a class="dropdown-item" href="../articles/Payoffs.html">Payoffs</a></li>
    <li><a class="dropdown-item" href="../articles/RecalibratingEPIC.html">RecalibratingEPIC</a></li>
    <li><a class="dropdown-item" href="../articles/Reproducing_bgd.html">Reproducing Background Mortality</a></li>
    <li><a class="dropdown-item" href="../articles/UsingEPICinR.html">Using EPIC in R</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calibrate Smoking Status</h1>
            
      

      <div class="d-none name"><code>Calibrate_Smoking.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>This document outlines the steps taken to calibrate the model to
align with U.S.-based validation targets for smoking behavior using a 25
year time horizon.</p>
<p>Smoking behavior data from the U.S. National Health Interview Survey
for the years 2018 and 2023 were used as validation targets.</p>
<p>Data from the 2018 U.S. National Health Interview Survey Table A-12b
(<a href="https://archive.cdc.gov/www_cdc_gov/nchs/nhis/shs/tables.htm" class="external-link uri">https://archive.cdc.gov/www_cdc_gov/nchs/nhis/shs/tables.htm</a>)
were used to calculate the proportion of current, former, and
non-smokers among adults aged 45 and over. Population counts were summed
for age groups 45–64, 65–74, and 75+, yielding a total of 134,448
individuals. Of these, 13.2% were identified as current smokers
(n=17,797), 29.3% as former smokers (n=39,351), and 57.2% as non-smokers
(n=76,873). While the EPIC model simulates individuals aged 40 and
older, the survey data were not stratified using a 40+ grouping;
therefore, individuals aged 45 and over were used as an appropriate
proxy for model validation.</p>
<p>To estimate the number and proportion of current exclusive cigarette
smokers among U.S. adults aged 45 and over in 2023, data from a 2025
MMWR report based on the National Health Interview Survey (DOI:
10.15585/mmwr.mm7407a3) were referenced. The estimated number of
exclusive cigarette smokers in 2023 was 8.77 million for adults aged
45–64 and 4.20 million for those aged 65 and older. Using the reported
prevalence rates—11.2% for ages 45–64 and 7.5% for ages 65 and
older—population denominators were back-calculated by dividing the
number of smokers by their respective prevalence estimates. This
resulted in an estimated population of 78.3 million adults aged 45–64
and 56.0 million aged 65 and older, totaling approximately 134.3 million
adults aged 45 and over. As with the 2018 data, the absence of a 40+ age
grouping required the use of 45 and over as a surrogate, resulting in an
estimated smoking prevalence of 9.7% (12.97 million of 134.3
million).</p>
<p>To project the future decline in the prevalence of cigarette smoking
among U.S. adults aged 40 and over after 2023, historical data from the
2025 MMWR report (DOI: 10.15585/mmwr.mm7407a3) was used. In 2017, the
number of exclusive cigarette smokers was estimated at 11.0 million for
adults aged 45–64 and 3.57 million for those aged 65 and older, totaling
14.57 million. By 2023, these figures declined to 8.77 million and 4.20
million, respectively, resulting in a combined total of 12.97 million
smokers aged 45 and over. The AAPC was calculated using the formula:
AAPC = ((Value 2023 / Value 2017) ^ (1/6)) - 1. This resulted in an
estimated AAPC of –1.9% per year. This historical trend was then applied
to model the projected year-over-year decline in smoking prevalence
beyond 2023.</p>
<p><strong>Summary of validation targets:</strong><br>
- <strong>Current smokers (2018):</strong> 13.2%<br>
- <strong>Former smokers (2018):</strong> 29.3%<br>
- <strong>Never smokers (2018):</strong> 57.5%<br>
- <strong>Current smokers (2023):</strong> 9.7%<br>
- <strong>AAPC after 2023:</strong> –1.9% per year</p>
</div>
<div class="section level3">
<h3 id="step-1-load-libraries-and-setup">Step 1: Load libraries and setup<a class="anchor" aria-label="anchor" href="#step-1-load-libraries-and-setup"></a>
</h3>
<p>Here, the necessary libraries are loaded. The default simulation
settings is set and the time horizon specified for the simulation (25
years).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">epicR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load EPIC general settings</span></span>
<span><span class="va">settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_default_settings.html">get_default_settings</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">settings</span><span class="op">$</span><span class="va">record_mode</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">settings</span><span class="op">$</span><span class="va">n_base_agents</span> <span class="op">&lt;-</span> <span class="fl">1e5</span></span>
<span><span class="fu"><a href="../reference/init_session.html">init_session</a></span><span class="op">(</span>settings <span class="op">=</span> <span class="va">settings</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_input.html">get_input</a></span><span class="op">(</span>jurisdiction <span class="op">=</span> <span class="st">"us"</span><span class="op">)</span></span>
<span><span class="va">time_horizon</span> <span class="op">&lt;-</span> <span class="fl">26</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">global_parameters</span><span class="op">$</span><span class="va">time_horizon</span> <span class="op">&lt;-</span> <span class="va">time_horizon</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-modify-intercept-value-to-calibrate-proportion-of-non-smokers-and-former-smokers-in-the-model">Step 2: Modify intercept value to calibrate proportion of
non-smokers and former smokers in the model<a class="anchor" aria-label="anchor" href="#step-2-modify-intercept-value-to-calibrate-proportion-of-non-smokers-and-former-smokers-in-the-model"></a>
</h3>
<p>EPIC’s existing calibration function (from EPIC Canada) accurately
matched the overall smoking rates from the 2018 Summary Health
Statistics: National Health Interview Survey (NHIS), however, it
underestimated the proportions of never and former smokers. To address
this, the intercepts that determines the probability of being a never
smoker and the probability of being a smoker at time of creation in the
logistic regression equation were modified.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify smoking rates</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">smoking</span><span class="op">$</span><span class="va">logit_p_current_smoker_0_betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="fl">0.35</span>, sex <span class="op">=</span> <span class="op">-</span><span class="fl">0.4</span>, age <span class="op">=</span> <span class="op">-</span><span class="fl">0.032</span>, age2 <span class="op">=</span> <span class="fl">0</span>, sex_age <span class="op">=</span> <span class="fl">0</span>, sex_age2 <span class="op">=</span> <span class="fl">0</span>, year <span class="op">=</span> <span class="op">-</span><span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">smoking</span><span class="op">$</span><span class="va">logit_p_never_smoker_con_not_current_0_betas</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">4.9</span>, sex <span class="op">=</span> <span class="fl">0</span>, age <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>, age2 <span class="op">=</span> <span class="fl">0</span>, sex_age <span class="op">=</span> <span class="fl">0</span>,sex_age2 <span class="op">=</span> <span class="fl">0</span>, year <span class="op">=</span> <span class="op">-</span><span class="fl">0.02</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-modify-rate-of-annual-rate-of-decline-in-proportion-of-current-smokers">Step 3: Modify rate of annual rate of decline in proportion of
current smokers<a class="anchor" aria-label="anchor" href="#step-3-modify-rate-of-annual-rate-of-decline-in-proportion-of-current-smokers"></a>
</h3>
<p>To align the model with validation targets for the proportion of
current smokers in 2018 and 2023, the intercept of the log-hazard
function for smoking cessation was adjusted to modify the rate of
decline in smoking prevalence.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify rate of decline</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">smoking</span><span class="op">$</span><span class="va">ln_h_ces_betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="op">-</span><span class="fl">3.35</span>,  sex <span class="op">=</span> <span class="fl">0</span>, age <span class="op">=</span> <span class="fl">0.02</span>, age2 <span class="op">=</span> <span class="fl">0</span>, calendar_time <span class="op">=</span> <span class="op">-</span><span class="fl">0.01</span>, diagnosis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.38</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-lower-minimum-prevalence-of-smoking">Step 4: Lower minimum prevalence of smoking<a class="anchor" aria-label="anchor" href="#step-4-lower-minimum-prevalence-of-smoking"></a>
</h3>
<p>The U.S. Healthy People initiative aims to reduce adult smoking
prevalence to 5%. To reflect this national policy goal and ensure face
validity of long-term projections, the minimum threshold for smoking
prevalence in the model was adjusted to 5%.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify lower bound prevalence of current smokers</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">smoking</span><span class="op">$</span><span class="va">minimum_smoking_prevalence</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-5-modify-intercept-value-to-calibrate-number-of-pack-years-smoked-in-current-and-former-smokers">Step 5: Modify intercept value to calibrate number of pack-years
smoked in current and former smokers<a class="anchor" aria-label="anchor" href="#step-5-modify-intercept-value-to-calibrate-number-of-pack-years-smoked-in-current-and-former-smokers"></a>
</h3>
<p>EPIC’s existing calibration function (from EPIC Canada)
underpredicted the pack-years of adults who ever smoked to that reported
in the Population Assessment of Tobacco and Health (PATH) Study (<a href="https://pubmed.ncbi.nlm.nih.gov/39461637/" class="external-link uri">https://pubmed.ncbi.nlm.nih.gov/39461637/</a>). Data
provided in 2018-2019 by the PATH Study estimated an average of 32.9
pack-years among adults who ever smoked (<a href="https://pubmed.ncbi.nlm.nih.gov/39461637/" class="external-link uri">https://pubmed.ncbi.nlm.nih.gov/39461637/</a>). To address
this, the intercept in the logistic regression equation that determines
pack-years of smoking at the time of creation was modified. Increasing
the intercept to 30 improved alignment with to data from PATH.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify pack years</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">smoking</span><span class="op">$</span><span class="va">pack_years_0_betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">30</span>, sex <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, age <span class="op">=</span> <span class="fl">0</span>, year <span class="op">=</span> <span class="op">-</span><span class="fl">0.6</span>, current_smoker <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-6-modify-mortality-ratios-for-age-groups">Step 6: Modify mortality ratios for age groups<a class="anchor" aria-label="anchor" href="#step-6-modify-mortality-ratios-for-age-groups"></a>
</h3>
<p>The mortality rates currently used in EPIC Canada did not include
mortality ratios for individuals under the age of 60. More recent data
from Cho et al.2024 (DOI: 10.1056/EVIDoa2300272; Table 2) provide
age-specific mortality hazard ratios, stratified by sex. As EPIC does
not model mortality by sex, the midpoint of the reported male and female
estimates for each age group was used. For the mortality ratio for
individuals over the age of 80, the estimates from Gillert et al.2012
were retained (DOI: 10.1001/archinternmed.2012.1397), as Cho et al.2024
did not report data for this population.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify mortality ratios for current smokers vs. non smokers</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">smoking</span><span class="op">$</span><span class="va">mortality_factor_current</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>age40to49 <span class="op">=</span> <span class="fl">2.33</span>, age50to59 <span class="op">=</span> <span class="fl">3.02</span>, age60to69 <span class="op">=</span> <span class="fl">2.44</span>, age70to79 <span class="op">=</span> <span class="fl">2.44</span>, age80p <span class="op">=</span> <span class="fl">1.66</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Modify mortality ratios for former smokers vs. non smokers</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">smoking</span><span class="op">$</span><span class="va">mortality_factor_former</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>age40to49 <span class="op">=</span> <span class="fl">1.31</span>, age50to59 <span class="op">=</span> <span class="fl">1.85</span>, age60to69 <span class="op">=</span> <span class="fl">1.91</span>, age70to79 <span class="op">=</span> <span class="fl">1.91</span>, age80p <span class="op">=</span> <span class="fl">1.27</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-7-run-epic">Step 7: Run EPIC<a class="anchor" aria-label="anchor" href="#step-7-run-epic"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Running EPIC model (with custom input parameters)</span></span></code></pre>
<pre><code><span><span class="co">## Record mode: record_mode_none (0)</span></span></code></pre>
<pre><code><span><span class="co">## Note: No events will be recorded. Use record_mode_event (2) or record_mode_agent (1) to record events.</span></span></code></pre>
<pre><code><span><span class="co">## Simulating 100000 base agents: 10% 20% 30% 40% 50%</span></span>
<span><span class="co">## 60% 70% 80% 90% 100%</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_output_ex.html">get_output_ex</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/terminate_session.html">terminate_session</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Terminating the session</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="step-8-create-data-tables">Step 8: Create data tables<a class="anchor" aria-label="anchor" href="#step-8-create-data-tables"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Calculate smoking proportions</span></span>
<span><span class="va">smokingstatus_overall</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">n_smoking_status_by_ctime</span></span>
<span><span class="va">row_sums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">smokingstatus_overall</span><span class="op">)</span></span>
<span><span class="va">smokingstatus_proportions</span> <span class="op">&lt;-</span> <span class="va">smokingstatus_overall</span> <span class="op">/</span> <span class="va">row_sums</span></span>
<span><span class="va">smokingstatus_proportions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">smokingstatus_proportions</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns for readability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">smokingstatus_proportions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Never Smoker"</span>, <span class="st">"Current Smoker"</span>, <span class="st">"Former Smoker"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add Year column</span></span>
<span><span class="va">smokingstatus_proportions</span><span class="op">$</span><span class="va">Year</span> <span class="op">&lt;-</span> <span class="fl">2015</span><span class="op">:</span><span class="fl">2040</span></span>
<span></span>
<span><span class="co"># Display summary of smoking status </span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">smokingstatus_proportions</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Year"</span>, <span class="st">"Never Smoker"</span>, <span class="st">"Current Smoker"</span>, <span class="st">"Former Smoker"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Proportion of Smoking Status Over Time"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Proportion of Smoking Status Over Time</caption>
<thead><tr class="header">
<th align="right">Year</th>
<th align="right">Never Smoker</th>
<th align="right">Current Smoker</th>
<th align="right">Former Smoker</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2015</td>
<td align="right">0.638</td>
<td align="right">0.156</td>
<td align="right">0.205</td>
</tr>
<tr class="even">
<td align="right">2016</td>
<td align="right">0.642</td>
<td align="right">0.143</td>
<td align="right">0.215</td>
</tr>
<tr class="odd">
<td align="right">2017</td>
<td align="right">0.646</td>
<td align="right">0.131</td>
<td align="right">0.222</td>
</tr>
<tr class="even">
<td align="right">2018</td>
<td align="right">0.649</td>
<td align="right">0.123</td>
<td align="right">0.228</td>
</tr>
<tr class="odd">
<td align="right">2019</td>
<td align="right">0.651</td>
<td align="right">0.116</td>
<td align="right">0.233</td>
</tr>
<tr class="even">
<td align="right">2020</td>
<td align="right">0.653</td>
<td align="right">0.110</td>
<td align="right">0.237</td>
</tr>
<tr class="odd">
<td align="right">2021</td>
<td align="right">0.656</td>
<td align="right">0.104</td>
<td align="right">0.240</td>
</tr>
<tr class="even">
<td align="right">2022</td>
<td align="right">0.658</td>
<td align="right">0.100</td>
<td align="right">0.242</td>
</tr>
<tr class="odd">
<td align="right">2023</td>
<td align="right">0.660</td>
<td align="right">0.096</td>
<td align="right">0.244</td>
</tr>
<tr class="even">
<td align="right">2024</td>
<td align="right">0.662</td>
<td align="right">0.093</td>
<td align="right">0.245</td>
</tr>
<tr class="odd">
<td align="right">2025</td>
<td align="right">0.664</td>
<td align="right">0.091</td>
<td align="right">0.246</td>
</tr>
<tr class="even">
<td align="right">2026</td>
<td align="right">0.666</td>
<td align="right">0.088</td>
<td align="right">0.247</td>
</tr>
<tr class="odd">
<td align="right">2027</td>
<td align="right">0.668</td>
<td align="right">0.085</td>
<td align="right">0.247</td>
</tr>
<tr class="even">
<td align="right">2028</td>
<td align="right">0.669</td>
<td align="right">0.083</td>
<td align="right">0.247</td>
</tr>
<tr class="odd">
<td align="right">2029</td>
<td align="right">0.670</td>
<td align="right">0.081</td>
<td align="right">0.248</td>
</tr>
<tr class="even">
<td align="right">2030</td>
<td align="right">0.672</td>
<td align="right">0.079</td>
<td align="right">0.248</td>
</tr>
<tr class="odd">
<td align="right">2031</td>
<td align="right">0.674</td>
<td align="right">0.078</td>
<td align="right">0.249</td>
</tr>
<tr class="even">
<td align="right">2032</td>
<td align="right">0.675</td>
<td align="right">0.077</td>
<td align="right">0.248</td>
</tr>
<tr class="odd">
<td align="right">2033</td>
<td align="right">0.676</td>
<td align="right">0.076</td>
<td align="right">0.248</td>
</tr>
<tr class="even">
<td align="right">2034</td>
<td align="right">0.678</td>
<td align="right">0.075</td>
<td align="right">0.247</td>
</tr>
<tr class="odd">
<td align="right">2035</td>
<td align="right">0.679</td>
<td align="right">0.074</td>
<td align="right">0.247</td>
</tr>
<tr class="even">
<td align="right">2036</td>
<td align="right">0.681</td>
<td align="right">0.073</td>
<td align="right">0.246</td>
</tr>
<tr class="odd">
<td align="right">2037</td>
<td align="right">0.682</td>
<td align="right">0.073</td>
<td align="right">0.246</td>
</tr>
<tr class="even">
<td align="right">2038</td>
<td align="right">0.683</td>
<td align="right">0.072</td>
<td align="right">0.245</td>
</tr>
<tr class="odd">
<td align="right">2039</td>
<td align="right">0.683</td>
<td align="right">0.072</td>
<td align="right">0.245</td>
</tr>
<tr class="even">
<td align="right">2040</td>
<td align="right">0.684</td>
<td align="right">0.070</td>
<td align="right">0.245</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="step-9-visualize-data">Step 9: Visualize data<a class="anchor" aria-label="anchor" href="#step-9-visualize-data"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reshape data for plotting</span></span>
<span><span class="va">smokingstatus_reshaped</span><span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>  <span class="va">smokingstatus_proportions</span>,</span>
<span>  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Never Smoker"</span>, <span class="st">"Current Smoker"</span>, <span class="st">"Former Smoker"</span><span class="op">)</span>,</span>
<span>  names_to <span class="op">=</span> <span class="st">"Status"</span>,</span>
<span>  values_to <span class="op">=</span> <span class="st">"Proportion"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Define colors</span></span>
<span><span class="va">poster_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Never Smoker"</span> <span class="op">=</span> <span class="st">"#003f5c"</span>,      </span>
<span>  <span class="st">"Current Smoker"</span> <span class="op">=</span> <span class="st">"#ffa600"</span>,   </span>
<span>  <span class="st">"Former Smoker"</span> <span class="op">=</span> <span class="st">"#66c2ff"</span>      </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot smoking status trends</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">smokingstatus_reshaped</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Proportion</span>, color <span class="op">=</span> <span class="va">Status</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">poster_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">2040</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Smoking Status Trends Over Time"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Smoking status from 2015–2040"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Proportion of Population"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Smoking Status"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">18</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="Calibrate_Smoking_files/figure-html/smokingstatus_reshaped-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level3">
<h3 id="step-10-observe-trend-in-pack-years-per-person">Step 10: Observe trend in pack years per person<a class="anchor" aria-label="anchor" href="#step-10-observe-trend-in-pack-years-per-person"></a>
</h3>
<p>This figure serves to assess the face validity of the simulated
trajectory of average pack-years per smoker over time. Due to the
absence of nationally representative longitudinal data on cumulative
smoking exposure (pack-years) in the United States, trends in smoking
intensity was used to estimate the impact on pack-years.</p>
<p>Evidence from Cornelius et al. 2022 published in the CDC’s Morbidity
and Mortality Weekly Report (DOI: 10.15585/mmwr.mm7111a1) highlights a
sustained decline in cigarette consumption among daily smokers between
2005 and 2020. During this period:</p>
<p>The proportion of adults reporting consumption of 20–29
cigarettes/day decreased from 34.9% to 27.9% Those smoking ≥30
cigarettes/day declined from 12.7% to 6.4% Conversely, the percentage
smoking 1–9 cigarettes/day increased from 16.4% to 25.0% Those smoking
10–19 cigarettes/day rose from 36.0% to 40.7%</p>
<p>These data reflect a broader shift toward lower daily cigarette
consumption, suggesting that, on average, smokers are now consuming
approximately half to one pack per day. In light of this, a projected
decline in cumulative pack-year exposure is both expected and
reasonable. The observed decrease in average pack-years per smoker in
the model is therefore aligned with empirically documented reductions in
smoking intensity, supporting the face validity of the simulated
trend.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate total pack years by year</span></span>
<span><span class="va">pack_years_total</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">sum_pack_years_by_ctime_sex</span><span class="op">)</span></span>
<span><span class="va">pack_years_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">pack_years_total</span><span class="op">)</span></span>
<span><span class="va">pack_years_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Year <span class="op">=</span> <span class="fl">2015</span><span class="op">:</span><span class="fl">2040</span>,</span>
<span>  packyears <span class="op">=</span> <span class="va">pack_years_total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate total number of current and former smokers by year</span></span>
<span></span>
<span><span class="va">smoking_history</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">n_smoking_status_by_ctime</span><span class="op">)</span></span>
<span><span class="va">smoking_history</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">smoking_history</span> <span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">smoking_history</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Year <span class="op">=</span> <span class="fl">2015</span><span class="op">:</span><span class="fl">2040</span>,</span>
<span>    n_smokers <span class="op">=</span> <span class="va">smoking_history</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge datasets by year</span></span>
<span><span class="va">pack_years_total_and_smoking_history</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">pack_years_total</span>, <span class="va">smoking_history</span>, by <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate average pack-years </span></span>
<span><span class="va">pack_year_per_person</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Year <span class="op">=</span> <span class="va">pack_years_total_and_smoking_history</span><span class="op">$</span><span class="va">Year</span>,</span>
<span>  AvgPackYearsPerSmoker <span class="op">=</span> <span class="va">pack_years_total_and_smoking_history</span><span class="op">$</span><span class="va">packyears</span> <span class="op">/</span> <span class="va">pack_years_total_and_smoking_history</span><span class="op">$</span><span class="va">n_smokers</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-11-visualize-trend-in-pack-years-per-person">Step 11: Visualize trend in pack years per person<a class="anchor" aria-label="anchor" href="#step-11-visualize-trend-in-pack-years-per-person"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pack_year_per_person</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">AvgPackYearsPerSmoker</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.5</span>, color <span class="op">=</span> <span class="st">"#003f5c"</span><span class="op">)</span> <span class="op">+</span>           </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"#66c2ff"</span>, stroke <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">2040</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Average Pack-Years per Smoker Over Time"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Estimated smoking exposure per smoker from 2015–2040"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Average Pack-Years"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">18</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="Calibrate_Smoking_files/figure-html/pack_years_per_person-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level3">
<h3 id="section"></h3>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mohsen Sadatsafavi, Amin Adibi, Kate Johnson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
